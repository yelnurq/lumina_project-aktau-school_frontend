import { useEffect, useState } from "react";
import Header from "../../../components/Header";
import styles from "./Circles.module.css";
import { Link } from "react-router-dom";
import { 
  FaLaptopCode, FaRobot, FaDumbbell, FaChess, 
  FaBook, FaLanguage, FaHome, FaStar 
} from "react-icons/fa";

// 1. Объект с переводами
const translations = {
  ru: {
    breadcrumbs: { home: "Главная", current: "Кружки" },
    pageTitle: "Кружки",
    sectionTitle: "Дополнительное образование и кружки",
    text1: "Наша школа предлагает широкий спектр дополнительных занятий и кружков, направленных на всестороннее развитие учеников. Мы помогаем детям раскрыть творческий, спортивный и интеллектуальный потенциал за рамками основной учебной программы.",
    text2: "Внеклассные занятия развивают важные социальные навыки, такие как работа в команде, дисциплина и самоорганизация. Регулярные занятия в кружках помогают формировать полезные привычки и интересы, которые могут стать основой для будущей профессии.",
    text3: "Ученики могут выбрать занятия по интересам:",
    cta: "Запишите вашего ребёнка на пробное занятие, чтобы он мог выбрать направление по душе!",
    cardsTitle: "Подробный список кружков",
    faqTitle: "Часто задаваемые вопросы о кружках",
    faq: [
      { q: "Как записаться в кружок?", a: "Запись производится через классного руководителя или напрямую у руководителя кружка. Заявление от родителей обязательно." },
      { q: "Со скольки лет можно посещать кружки?", a: "Большинство кружков доступны для учеников с 1-го класса. Некоторые спортивные и технические секции могут иметь ограничения по возрасту." },
      { q: "Какова продолжительность занятий?", a: "Продолжительность одного занятия обычно составляет 45 или 60 минут, в зависимости от направления и возраста учеников." },
      { q: "Можно ли посещать несколько кружков одновременно?", a: "Да, ученик может посещать любое количество кружков, если расписание не пересекается и нагрузка не вредит основной учёбе." }
    ],
    circles: [
      { name: "IT (Программирование)", desc: "Освоение основ кодирования, создание простых игр и приложений." },
      { name: "Робототехника", desc: "Конструирование, программирование и управление роботами." },
      { name: "Гимнастика", desc: "Развитие гибкости, координации и силы, формирование правильной осанки." },
      { name: "Каратэ", desc: "Обучение боевым искусствам, развитие дисциплины и самоконтроля." },
      { name: "Шахматы", desc: "Тренировка логического мышления, стратегического планирования и памяти." },
      { name: "Английский язык", desc: "Углубленное изучение лексики и грамматики, практика разговорной речи." },
      { name: "Русский язык", desc: "Повышение грамотности, развитие навыков письма и анализа текста." },
      { name: "Выполнение домашнего задания", desc: "Организованная помощь и контроль при подготовке домашних заданий." }
    ]
  },
  kk: {
    breadcrumbs: { home: "Басты бет", current: "Үйірмелер" },
    pageTitle: "Үйірмелер",
    sectionTitle: "Қосымша білім беру және үйірмелер",
    text1: "Біздің мектеп оқушылардың жан-жақты дамуына бағытталған қосымша сабақтар мен үйірмелердің кең таңдауын ұсынады. Біз балаларға негізгі оқу бағдарламасынан тыс шығармашылық, спорттық және зияткерлік әлеуетін ашуға көмектесеміз.",
    text2: "Сыныптан тыс жұмыстар командада жұмыс істеу, тәртіп және өзін-өзі ұйымдастыру сияқты маңызды әлеуметтік дағдыларды дамытады. Үйірмелердегі тұрақты сабақтар болашақ мамандықтың негізі бола алатын пайдалы әдеттер мен қызығушылықтарды қалыптастыруға көмектеседі.",
    text3: "Оқушылар өз қызығушылықтары бойынша сабақтарды таңдай алады:",
    cta: "Балаңызды өзіне ұнайтын бағытты таңдауы үшін сынақ сабағына жазыңыз!",
    cardsTitle: "Үйірмелердің толық тізімі",
    faqTitle: "Үйірмелер туралы жиі қойылатын сұрақтар",
    faq: [
      { q: "Үйірмеге қалай жазылуға болады?", a: "Жазылу сынып жетекшісі арқылы немесе тікелей үйірме жетекшісі арқылы жүзеге асырылады. Ата-ананың өтініші міндетті." },
      { q: "Үйірмелерге неше жастан бастап баруға болады?", a: "Үйірмелердің көпшілігі 1-сынып оқушылары үшін қолжетімді. Кейбір спорттық және техникалық секцияларда жас шектеулері болуы мүмкін." },
      { q: "Сабақтың ұзақтығы қандай?", a: "Бір сабақтың ұзақтығы бағытына және оқушылардың жасына байланысты әдетте 45 немесе 60 минутты құрайды." },
      { q: "Бір уақытта бірнеше үйірмеге баруға бола ма?", a: "Иә, егер кесте сәйкес келсе және жүктеме негізгі оқуға зиян тигізбесе, оқушы кез келген үйірмелер санына қатыса алады." }
    ],
    circles: [
      { name: "IT (Бағдарламалау)", desc: "Кодтау негіздерін меңгеру, қарапайым ойындар мен қосымшалар жасау." },
      { name: "Робототехника", desc: "Роботтарды құрастыру, бағдарламалау және басқару." },
      { name: "Гимнастика", desc: "Икемділікті, үйлесімділікті және күшті дамыту, дұрыс қалыпты қалыптастыру." },
      { name: "Каратэ", desc: "Жекпе-жек өнеріне үйрету, тәртіп пен өзін-өзі бақылауды дамыту." },
      { name: "Шахмат", desc: "Логикалық ойлауды, стратегиялық жоспарлауды және жадты жаттықтыру." },
      { name: "Ағылшын тілі", desc: "Лексика мен грамматиканы тереңдетіп оқыту, сөйлеу тәжірибесі." },
      { name: "Орыс тілі", desc: "Сауаттылықты арттыру, жазу және мәтінді талдау дағдыларын дамыту." },
      { name: "Үй тапсырмасын орындау", desc: "Үй тапсырмасын дайындау кезінде ұйымдасқан көмек және бақылау." }
    ]
  }
};

// Соответствие иконок (поскольку иконки — это компоненты, храним их отдельно)
const iconMap = [
  <FaLaptopCode />, <FaRobot />, <FaDumbbell />, <FaStar />, 
  <FaChess />, <FaLanguage />, <FaBook />, <FaHome />
];

export default function Circles() {
  const [openFAQ, setOpenFAQ] = useState(null);
  const [lang, setLang] = useState(localStorage.getItem('app_lang') || 'ru');
  const t = translations[lang];

  const toggleFAQ = (index) => {
    setOpenFAQ(openFAQ === index ? null : index);
  };

  // Синхронизация языка
  useEffect(() => {
    const handleStorageChange = () => {
      setLang(localStorage.getItem('app_lang') || 'ru');
    };
    const interval = setInterval(handleStorageChange, 500);
    return () => clearInterval(interval);
  }, []);

  return (
    <Header>
      <div className={styles.container}>
        <section
          className={styles.pageHeader}
          style={{ backgroundImage: `url('/images/elementary-school-classroom-design.jpg')` }}
        >
          <div className={styles.overlay}>
            <div className={styles.main}>
              <div className={styles.inner}>
                <nav className={styles.breadcrumbs}>
                  <ol>
                    <li><Link to="/">{t.breadcrumbs.home}</Link></li>
                    <li>/</li>
                    <li>{t.breadcrumbs.current}</li>
                  </ol>
                </nav>
                <h1 className={styles.pageTitle}>{t.pageTitle}</h1>
              </div>
            </div>
          </div>
        </section>

        <section className={styles.committeeSection}>
          <div className={styles.sectionContent}>
            <h2>{t.sectionTitle}</h2>
            <p>{t.text1}</p>
            <p>{t.text2}</p>
            <p>{t.text3}</p>

            <ul className={styles.circlesList}>
              {t.circles.map((item, index) => (
                <li key={index}>{item.name}</li>
              ))}
            </ul>

            <p>{t.cta}</p>
          </div>
        </section>

        <section className={styles.cardsSection}>
          <h2>{t.cardsTitle}</h2>
          <div className={styles.cardsGrid}>
            {t.circles.map((circle, index) => (
              <div key={index} className={styles.card}>
                <div className={styles.iconWrapper}>
                  {/* Оборачиваем иконку из массива iconMap в класс из CSS модуля */}
                  {iconMap[index] && <div className={styles.icon}>{iconMap[index]}</div>}
                </div>
                <h3>{circle.name}</h3>
                <p>{circle.desc}</p>
              </div>
            ))}
          </div>
        </section>

        <section className={styles.faqSection} style={{ marginTop: 50 }}>
          <h2>{t.faqTitle}</h2>
          <div className={styles.faqList}>
            {t.faq.map((item, index) => (
              <div
                key={index}
                className={`${styles.faqItem} ${openFAQ === index ? styles.open : ""}`}
                onClick={() => toggleFAQ(index)}
              >
                <h3>{item.q}</h3>
                {openFAQ === index && <p>{item.a}</p>}
              </div>
            ))}
          </div>
        </section>
      </div>
    </Header>
  );
}